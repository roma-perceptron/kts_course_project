# ФИНАЛЬНЫЙ ЭТАП ЗАДАЧИ и ДЕЙСТВИЯ

## Общие
- [ ] Дописать мягкое завершение всех процессов: бд, поллеры и т.д.
- [ ] TODO

## Telegram Bot
- [x] Нужно набросать общую логику работы бота в качестве бота-ЧГК
- [x] В общем виде собрал заготовку машины состояний для игры
- [x] Сделал команды-состояния для вступления в команду
- [x] Проработал логику интерфейса по формированию команды - до момента старта игры
- [?] Надо реализовать в минимуме логику одной целой игры
- [ ] TODO

## CHAT-GPT
- [x] Проверить базовую реализуемость идеи, получить аккаунт на openAI
- [x] Собрать прототип библы для получения вопросов
- [ ] Подобрать структуру промтов для формирования хороших вопросов
- [ ] TODO

## База данных
- [ ] Модифицировать БД под ЧКГ
- [ ] TODO

## Аксессоры/Manager
- [ ] TODO

## AIOHTTP-приложение
- [ ] Разобраться почему не работает без async в setup_app.. или пофиг уже
- [ ] TODO

## Тесты
- [ ] TODO

---



# ПРЕДВАРИТЕЛЬНЫЙ ЭТАП - ЗАДАЧИ и ДЕЙСТВИЯ

## ИЗ ЗАДАНИЯ:
- [x] Ознакомиться с памяткой
- [x] Сделать fork проекта из памятки 
- [x] Cделать ветку dev
- [x] Cделать ветку init
- [x] В ветке init нужно реализовать следующие моменты:
    - [x] Реализовать polling server + создать бота в ВК / Телеграмм
    - [x] Реализовать echo бота, который должен дублировать отправленные сообщения
    - [x] Прикрутить alembic к проекту
    - [x] Реализовать модель игры, пользователя, счета пользователя
    - [x] Реализовать модели аксессора для:
        - [x] получения пользователей в чате (получение всех уникальных пользователей принимавших участие в играх)
        - [x] создание игры со всеми связанными сущностями (пользователь, игра, счет пользователя)
        - [x] получение последней игры вместе со всеми связанными сущностями по char_id
    

## Общие
- [x] Установить доп. библиотеки (алчеми, алембик..)
- [x] Отредактировать readme добавив инфу о себе
- [x] Применить black для форматирования..
- [x] Залить все на гитхаб
- [ ] TODO


## База данных
- [x] Создать локальную БД
- [x] Добавил в */kts_project_template/venv/bin/activate* свои переменные (путь к БД)
- [x] Настроить универсальное подключение к БД
- [x] Создать базовые модели
- [x] Сделать init миграцию
- [x] Написать базовый аксессор для записи в БД и получения данных из нее
- [x] Собрал БД так что все вроде работает
- [x] Добавил методы для тестового залива данных и тестового просмотра - работает
- [x] Сделал метод получения последней игры в заданном chat_id
- [ ] TODO

  
## Telegram Bot
- [x] Создать Бота
- [x] Добавить его token в переменные окружения
- [x] Примерно накидать архитектуру будущего функционала
- [x] Написал базовые классы Бота. Реализован getUpdates и sendMessage
- [x] Усложнил Poller - при получении сообщения он кладет его в очередь updates_queue
- [x] Усложнил Sender - он следит за очередью answers_queue и отправляет сообщения из нее
- [x] Эхо-бот готов
- [x] Добавил наивную обработку команд (/help)
- [x] Накидал код для создания объекта-игры
- [x] Переделал команды
- [ ] TODO

## Аксессоры/Manager
- [x] Нужно написать аксессор Бота, который бы запускался в приложении и уже сам реализовывал свою логику
- [x] Сделал менеджер который следит за очередью updates_queue, превращает ее элементы в ответы и кладет в answers_queue
- [x] Сделал аксессор для БД, он может записывать данные в базу и читать из нее
- [ ] TODO


## AIOHTTP-приложение
- [x] Базовое, внутри которого запускаются три корутины обменивающиеся данными через две очереди
- [ ] TODO
